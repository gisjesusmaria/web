<!-- 27122025_0942 -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EXPERIENCIA FESTIVALERA 2026</title>
  <link rel="icon" href="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/favicon.ico">

  <style>



    :root{
      --bg1:#f4f7fb;
      --card:#ffffff;
      --text:#371f1f;
      --muted:#000000;
      --primary:#f56505;
      --primary2:#f0ac53;

     
      --swanky-bg:#eec19d;
      --swanky-hover:#e09375;
      --swanky-border:#f0bc4e;
      --swanky-accent:#fafafa;
      --swanky-item:#f2f5f7;
      --swanky-item-hover:#f3e2d3;
      --swanky-inset:#a11212;
      --radius:12px;
    }    


    *{box-sizing:border-box}
    body{
      margin:0;
      padding:24px 14px 48px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 20% 0%, #e9f1ff 0%, var(--bg1) 40%, #f6f0ff 100%);
      color:var(--text);
    }

    img.logo{
      max-width: min(420px, 36%);
      display:block;
      margin: 0 auto 18px auto;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.10);
    }

    h1{
      color: #d35400; 
      text-align:center;
      margin: 0 0 10px;
      letter-spacing:.3px;
      font-size: clamp(22px, 3.2vw, 34px);
    }

    .description{
      max-width: 860px;
      margin: 0 auto 18px;
      text-align:center;
      color:var(--muted);
      line-height:1.45;
      font-size: 15px;
    }

    form{
      max-width: 860px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 16px;
      padding: 18px 16px 20px;
      box-shadow: 0 10px 30px rgba(17,24,39,0.08);
    }

    label{
      display:block;
      margin-top: 14px;
      margin-bottom: 8px;
      font-weight: 700;
      color:#111827;
    }
    label.required::after{
      content:" *";
      color:#e74c3c;
      font-weight:800;
    }

    input[type="text"], textarea, select{
      width:100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.12);
      outline:none;
      font-size: 15px;
      background:#fff;
    }
    input[type="text"]:focus, textarea:focus, select:focus{
      border-color: rgba(66,133,244,0.7);
      box-shadow: 0 0 0 4px rgba(66,133,244,0.15);
    }
    textarea{
      height: 120px;
      resize: vertical;
    }

    button{
      margin-top: 22px;
      width: 100%;
      padding: 14px;
      background: linear-gradient(to left, var(--primary), #ffad76);
      color:white;
      border:none;
      border-radius: 12px;
      cursor:pointer;
      font-size: 1.05em;
      font-weight: 800;
      transition: transform .15s ease, filter .2s ease;
    }
    button:hover{
      filter: brightness(0.98);
      transform: translateY(-1px);
    }

    .hidden{ display:none; }

    
    .satisfaction{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      margin: 10px 0 6px;
      flex-wrap: wrap;
    }
    .satisfaction label{
      margin:0;
      font-weight: 400;
      cursor:pointer;
      transition: transform .15s ease;
    }
    .satisfaction label:hover{ transform: scale(1.05); }
    .satisfaction input{ display:none; }
    .satisfaction input:checked + img{
      border: 2px solid var(--primary);
      border-radius: 50%;
      box-shadow: 0 0 10px rgba(66,133,244,0.35);
    }
    .satisfaction img{
      width: 46px;
      height: 46px;
      padding: 6px;
      border-radius: 50%;
      background:#fff;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

    .transport{
      display:flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 4px;
      margin-bottom: 6px;
    }
    .transport label{
      margin:0;
      font-weight:400;
      cursor:pointer;
      transition: transform .15s ease;
      text-align:center;
    }
    .transport label:hover{ transform: scale(1.03); }
    .transport input{ display:none; }
    .transport input:checked + img{
      border: 2px solid var(--primary);
      border-radius: 14px;
      box-shadow: 0 0 10px rgba(66,133,244,0.30);
    }
    .transport-icon{
      height: auto;
      padding: 12px;
      border-radius: 14px;
      background:#fff;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    .transport .transport-auto{ width: 80px; }
    .transport .transport-camioneta{ width: 100px; }
    .transport .transport-moto{ width: 70px; }
    .transport .transport-colectivo{ width: 90px; }
    .transport .transport-otro{ width: 80px; }


    .native-select{
      
      position:absolute !important;
      left:-9999px !important;
      width:1px !important;
      height:1px !important;
      opacity:0 !important;
      pointer-events:none !important;
    }

    .swankySelect{
      width: 100%;
      border-radius: 12px;
      overflow:hidden;
      background: var(--swanky-bg);
      box-shadow: 0 8px 18px rgba(17,24,39,0.10);
      border: 1px solid rgba(255,255,255,0.06);
    }

    .swankyBtn{
      width:100%;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      background: transparent;
      border:0;
      color: rgb(0, 0, 0);
      padding: 14px 14px;
      cursor:pointer;
      font-weight: 800;
      font-size: 15px;
      text-align:left;
    }
    .swankyBtn:hover{
      background: var(--swanky-hover);
    }

    .swankyBtn .swankyLeft{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .swankyPill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: rgba(20,163,249,0.18);
      color: #cfe9ff;
      font-weight: 900;
      font-size: 12px;
      flex: 0 0 auto;
    }
    .swankyValue{
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      font-weight: 700;
      color: rgba(0, 0, 0, 0.92);
    }
    .swankyPlaceholder{
      color: rgba(0, 0, 0, 0.65);
      font-weight: 600;
    }

    .swankyArrow{
      width: 10px;
      height: 10px;
      border-top: 2px solid rgba(255,255,255,0.85);
      border-right: 2px solid rgba(255,255,255,0.85);
      transform: rotate(45deg);
      transition: transform .25s cubic-bezier(0.68,-0.55,0.265,1.55), border-color .2s ease;
      flex: 0 0 auto;
      margin-right: 2px;
    }
    .swankySelect[data-open="true"] .swankyArrow{
      transform: rotate(135deg);
      border-top-color: var(--swanky-accent);
      border-right-color: var(--swanky-accent);
    }

    .swankyList{
      display:none;
      padding: 0;
      margin: 0;
      list-style:none;
      border-top: 1px solid rgba(255,255,255,0.06);
      max-height: 260px;
      overflow:auto;
    }
    .swankySelect[data-open="true"] .swankyList{
      display:block;
    }

    .swankyItem{
      padding: 12px 14px;
      color:rgb(0, 0, 0);
      background: var(--swanky-item);
      cursor:pointer;
      transition: background .15s ease, box-shadow .2s ease, padding-left .2s ease;
      box-shadow: 0 0 var(--swanky-inset) inset;
      font-weight: 650;
    }
    .swankyItem:hover{
      background: var(--swanky-item-hover);
      box-shadow: 4px 0 var(--swanky-inset) inset;
      padding-left: 18px;
    }
    .swankyItem[aria-selected="true"]{
      outline: 2px solid rgba(255,255,255,0.45);
      outline-offset: -2px;
    }

    
    #map-container{ margin-top: 14px; }


    
    .overlay.hidden{ display:none; }
    .overlay{
    position: fixed;
    inset: 0;
    background: rgba(17,24,39,0.55);
    backdrop-filter: blur(4px);
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 18px;
    z-index: 9999;
    }

    .overlayCard{
    width: min(420px, 92vw);
    background: #fff;
    border-radius: 18px;
    padding: 22px 18px;
    box-shadow: 0 18px 60px rgba(0,0,0,0.25);
    text-align:center;
    }

    .overlayTitle{
    font-weight: 900;
    font-size: 18px;
    margin-top: 12px;
    color: #111827;
    }

    .overlaySub{
    margin-top: 6px;
    color: #6b7280;
    font-weight: 600;
    }

    
    .spinner{
    width: 54px;
    height: 54px;
    margin: 4px auto 0;
    border-radius: 50%;
    border: 6px solid rgba(224,147,117,0.25); 
    border-top-color: #e09375;               
    animation: spin .85s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    
    .checkWrap{
    width: 72px;
    height: 72px;
    margin: 0 auto;
    }
    .checkSvg{
    width: 72px;
    height: 72px;
    }
    .checkCircle{
    stroke: #22c55e;
    stroke-width: 4;
    stroke-dasharray: 151;
    stroke-dashoffset: 151;
    animation: drawCircle .45s ease forwards;
    }
    .checkMark{
    stroke: #16a34a;
    stroke-width: 5;
    stroke-linecap: round;
    stroke-linejoin: round;
    stroke-dasharray: 48;
    stroke-dashoffset: 48;
    animation: drawCheck .35s .35s ease forwards;
    }
    @keyframes drawCircle{ to{ stroke-dashoffset: 0; } }
    @keyframes drawCheck{ to{ stroke-dashoffset: 0; } }

    .successText{ color:#16a34a; }

    .overlayBtn{
    margin-top: 16px;
    width: 100%;
    padding: 12px 14px;
    border-radius: 12px;
    border: 0;
    background: #111827;
    color: #fff;
    font-weight: 800;
    cursor: pointer;
    }
    .overlayBtn:hover{ filter: brightness(1.05); }


    
    .fieldError{
    outline: 3px solid rgba(225, 29, 72, 0.25);
    border-color: rgba(225, 29, 72, 0.9) !important;
    box-shadow: 0 0 0 4px rgba(225, 29, 72, 0.10);
    }

    .groupError{
    border: 2px solid rgba(225, 29, 72, 0.85);
    border-radius: 14px;
    padding: 10px;
    background: rgba(225, 29, 72, 0.06);
    }

    .errorHint{
    margin-top: 8px;
    padding: 10px 12px;
    border-radius: 12px;
    background: rgba(220, 38, 38, 0.10);
    color: #dc2626;    
    font-weight: 800;
    font-size: 14px;
    }


    .multiChoice{
    display:flex;
    flex-direction: column;
    gap: 10px;
    padding: 12px 14px;
    border-radius: 12px;
    border: 1px solid rgba(0,0,0,0.12);
    background:#fff;
    }
    .multiChoice label{
    margin:0;
    font-weight:600;
    cursor:pointer;
    display:flex;
    gap:10px;
    align-items:flex-start;
    }
    .multiChoice input[type="checkbox"]{
    transform: translateY(2px);
    }

    .ratingBreak{
    margin: 18px 0 10px;
    text-align:center;
    }
    .ratingBreak img{
    width: min(560px, 100%);
    height: auto;
    display:inline-block;
    }

    .required-asterisk {
    color: red;
    font-weight: bold;
    margin-left: 4px;
    }


  </style>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
</head>

<body>
  <img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/Logos/Logo01ConFondoWide.png"
       alt="Logo Municipalidad" class="logo">

  <h1>EXPERIENCIA FESTIVALERA 2026</h1>
  <p class="description">
    ¬°Tu opini√≥n es invaluable! Participa en nuestra encuesta para conocer tu paso por el Festival Nacional de Doma y Folklore.
    Tu participaci√≥n nos ayudar√° a mejorar y enriquecer futuras ediciones. ¬°Gracias por ser parte de esta experiencia √∫nica!
  </p>

  <form id="myForm" novalidate>
    <!-- q1 -->
    <label for="q1" class="required">Encuestador/a</label>
    <select id="q1" name="q1" required class="native-select">
      <option value="">Selecciona.</option>
        <option value="Ana">Ana</option>
        <option value="Eliana">Eliana</option>
        <option value="Facundo">Facundo</option>
        <option value="Fiona">Fiona</option>
        <option value="Marcos">Marcos</option>
        <option value="Pilar">Pilar</option>
        <option value="Sofia">Sofia</option>
    </select>
    <div class="swankySelect" data-for="q1"></div>

    <!-- q2 -->
    <label for="q2" class="required">Lugar de Procedencia</label>
    <select id="q2" name="q2" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Vecino de la zona (Jes√∫s Mar√≠a, Colonia Caroya, Sinsacate)">Vecino de la zona (Jes√∫s Mar√≠a, Colonia Caroya, Sinsacate)</option>
      <option value="Interior de la Provincia de C√≥rdoba">Interior de la Provincia de C√≥rdoba</option>
      <option value="Cordoba Capital">Cordoba Capital</option>
      <option value="Otra provincia">Otra provincia</option>
      <option value="Exterior">Exterior</option>
    </select>
    <div class="swankySelect" data-for="q2"></div>

    <!-- <div id="q3-container" class="hidden">
      <label id="q3-label" for="q3">1.a- En caso de ser del interior de la provincia, de otra provincia, o del exterior, especificar localidad, provincia o pa√≠s</label>
      <input type="text" id="q3" name="q3">
    </div> -->

    <!-- q4 transport -->
    <label class="required">¬øEn qu√© transporte viniste a la ciudad?</label>
    <div class="transport" id="q4">
      <label><input type="radio" name="q4" value="Auto" required><img class="transport-icon transport-auto" src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/autoR.png" alt="Auto"></label>
      <label><input type="radio" name="q4" value="Camioneta"><img class="transport-icon transport-camioneta" src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/camionetaR.png" alt="Camioneta"></label>
      <label><input type="radio" name="q4" value="Moto"><img class="transport-icon transport-moto" src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/motoR.png" alt="Moto"></label>
      <label><input type="radio" name="q4" value="Colectivo"><img class="transport-icon transport-colectivo" src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/colectivoR.png" alt="Colectivo"></label>
      <label><input type="radio" name="q4" value="Otro"><img class="transport-icon transport-otro" src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/otroR.png" alt="Otro"></label>
    </div>

    <!-- q5 -->
    <label for="q5" class="required">¬øCu√°ntos kil√≥metros viajaste aproximadamente?</label>
    <select id="q5" name="q5" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Menos de 50 km">Menos de 50 km</option>
      <option value="Entre 50 km y 150 km">Entre 50 km y 150 km</option>
      <option value="Entre 150 km y 300 km">Entre 150 km y 300 km</option>
      <option value="Entre 300 km y 500 km">Entre 300 km y 500 km</option>
      <option value="Entre 500 km y 1000 km">Entre 500 km y 1000 km</option>
      <option value="M√°s de 1000 km">M√°s de 1000 km</option>
    </select>
    <div class="swankySelect" data-for="q5"></div>

    <!-- q6 -->
    <label for="q6" class="required">¬øCon qui√©n viniste al festival?</label>
    <select id="q6" name="q6" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Solo">Solo/a</option>
      <option value="En pareja">En pareja</option>
      <option value="Grupo familiar">Grupo familiar</option>
      <option value="Grupo de amigos">Grupo de amigos</option>
    </select>
    <div class="swankySelect" data-for="q6"></div>

    <!-- q7 -->
    <label for="q7" class="required">Edad de la persona encuestada</label>
    <select id="q7" name="q7" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="15 a 19 a√±os">15 a 19 a√±os</option>
      <option value="20 a 29 a√±os">20 a 29 a√±os</option>
      <option value="30 a 39 a√±os">30 a 39 a√±os</option>
      <option value="40 a 49 a√±os">40 a 49 a√±os</option>
      <option value="50 a 59 a√±os">50 a 59 a√±os</option>
      <option value="60 a 69 a√±os">60 a 69 a√±os</option>
      <option value="70 a√±os o m√°s">70 a√±os o m√°s</option>
    </select>
    <div class="swankySelect" data-for="q7"></div>

    <!-- q8 -->
    <label for="q8" class="required">Cantidad de d√≠as que permanecer√°s en la ciudad</label>
    <select id="q8" name="q8" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Vive ac√°">Vive ac√°</option>
      <option value="1 d√≠a">1 d√≠a</option>
      <option value="1 a 3 d√≠as">1 a 3 d√≠as</option>
      <option value="3 a 7 d√≠as">3 a 7 d√≠as</option>
      <option value="7 a 10 d√≠as">7 a 10 d√≠as</option>
    </select>
    <div class="swankySelect" data-for="q8"></div>

    <!-- q9 -->
    <label for="q9" class="required">En caso de alojarte en la zona, ¬øEn qu√© ciudad lo haces?</label>
    <select id="q9" name="q9" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Jes√∫s Mar√≠a">Jes√∫s Mar√≠a</option>
      <option value="Colonia Caroya">Colonia Caroya</option>
      <option value="Sinsacate">Sinsacate</option>
      <option value="Otra">Otra</option>
      <option value="No se hospeda (viene y regresa a su hogar en el d√≠a)">No se hospeda (viene y regresa a su hogar en el d√≠a)</option>
    </select>
    <div class="swankySelect" data-for="q9"></div>

    <div id="q10-container" class="hidden">
      <!-- <label for="q10">En caso de ser otra, especificar cu√°l</label>
      <input type="text" id="q10" name="q10"> -->

        <label for="q10">
        En caso de ser otra, especificar cu√°l
        <span id="q10-asterisk" class="required-asterisk hidden">*</span>
        </label>

        <input type="text" id="q10" name="q10">

    </div>

    <!-- q11 -->
    <label for="q11" class="required">Cantidad de noches que ingresar√°s al Anfiteatro</label>
    <select id="q11" name="q11" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Ninguna">Ninguna</option>
      <option value="1 noche">1 noche</option>
      <option value="Entre 2 y 5 noches">Entre 2 y 5 noches</option>
      <option value="Entre 6 y 9 noches">Entre 6 y 9 noches</option>
      <option value="M√°s de 9 noches">M√°s de 9 noches</option>
    </select>
    <div class="swankySelect" data-for="q11"></div>

    <!-- q12 -->
    <label for="q12" class="required">¬øEs la primera vez que ingresas al festival?</label>
    <select id="q12" name="q12" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Si">Si</option>
      <option value="No">No</option>
    </select>
    <div class="swankySelect" data-for="q12"></div>

    <!-- q13 -->
    <!-- <label for="q13" class="required">¬øPor qu√© ven√≠s al Festival de Jes√∫s Mar√≠a?</label>
    <select id="q13" name="q13" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Por el show art√≠stico (espect√°culo musical)">Por el show art√≠stico (espect√°culo musical)</option>
      <option value="Por la jineteada">Por la jineteada</option>
      <option value="Para recorrer los alrededores del Anfiteatro">Para recorrer los alrededores del Anfiteatro</option>
    </select>
    <div class="swankySelect" data-for="q13"></div> -->

    <!-- q13 (MULTI) -->
    <!-- <label class="required">¬øPor qu√© ven√≠s al Festival de Jes√∫s Mar√≠a?</label>
    <div class="multiChoice" id="q13Multi">
    <label><input type="checkbox" name="q13" value="Por el show art√≠stico (espect√°culo musical)"> Por el show art√≠stico (espect√°culo musical)</label>
    <label><input type="checkbox" name="q13" value="Por la jineteada"> Por la jineteada</label>
    <label><input type="checkbox" name="q13" value="Para recorrer los alrededores del Anfiteatro"> Para recorrer los alrededores del Anfiteatro</label>
    </div> -->


    <label class="required">¬øPor qu√© ven√≠s al Festival de Jes√∫s Mar√≠a?</label>

    <div class="multiChoice" id="q13Multi">
    <!-- ‚úÖ este hidden es el que viaja como q13 -->
    <input type="hidden" id="q13" name="q13" value="">

    <!-- ‚úÖ los checks ya NO se llaman q13 -->
    <label><input type="checkbox" name="q13_cb" value="Por el show art√≠stico (espect√°culo musical)"> Por el show art√≠stico (espect√°culo musical)</label>
    <label><input type="checkbox" name="q13_cb" value="Por la jineteada"> Por la jineteada</label>
    <label><input type="checkbox" name="q13_cb" value="Para recorrer los alrededores del Anfiteatro"> Para recorrer los alrededores del Anfiteatro</label>
    </div>


    <!-- q14 -->
    <label for="q14" class="required">Teniendo en cuenta alojamiento, comida, movilidad y gastos varios, ¬øCu√°l es el gasto aproximado por persona por d√≠a</label>
    <select id="q14" name="q14" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Menos de $80.000">Menos de $80.000</option>
      <option value="Entre $80.000 y $100.000">Entre $80.000 y $100.000</option>
      <option value="Entre $100.000 y $150.000">Entre $100.000 y $150.000</option>
      <option value="Entre $150.000 y $200.000">Entre $150.000 y $200.000</option>
      <option value="M√°s de $200.000">M√°s de $200.000</option>
    </select>
    <div class="swankySelect" data-for="q14"></div>

    <label for="qAloj" class="required">En caso de alojarte, en qu√© tipo de alojamiento lo haces?</label>
    <select id="qAloj" name="qAloj" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Alojamiento alternativo categor√≠a A">Alojamiento alternativo categor√≠a A</option>
      <option value="Alojamiento alternativo categor√≠a B">Alojamiento alternativo categor√≠a B</option>
      <option value="Alojamiento alternativo categor√≠a C">Alojamiento alternativo categor√≠a C</option>
      <option value="Alojamiento permanente">Alojamiento permanente</option>
      <option value="Hotel / posada">Hotel / posada</option>
      <option value="Camping">Camping</option>
      <option value="En casa de amigos/familiares">En casa de amigos/familiares</option>
    </select>
    <div class="swankySelect" data-for="qAloj"></div>    


    <div class="ratingBreak">
    <img
        src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/las5caritas_conDsMin.png"
        alt="Secci√≥n con valoraci√≥n">
    </div>


    <!-- q15 satisfacci√≥n -->
    <label class="required">Experiencia de alojamiento</label>
    <div class="satisfaction" id="q15">
      <label><input type="radio" name="q15" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q15" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q15" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q15" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q15" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <div id="q16-container" class="hidden">
      <label for="q16">En caso de calificar en 1 o 2, ¬øa qu√© se debe la insatisfacci√≥n? (Describir motivo e identificaci√≥n del alojamiento, de ser posible)</label>
      <textarea id="q16" name="q16"></textarea>
    </div>

    <!-- q17 -->
    <label class="required">Limpieza de calles</label>
    <div class="satisfaction" id="q17">
      <label><input type="radio" name="q17" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q17" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q17" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q17" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q17" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <!-- q18 -->
    <label class="required">Limpieza de ba√±os</label>
    <div class="satisfaction" id="q18">
      <label><input type="radio" name="q18" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q18" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q18" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q18" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q18" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <!-- q19 -->
    <label class="required">Seguridad</label>
    <div class="satisfaction" id="q19">
      <label><input type="radio" name="q19" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q19" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q19" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q19" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q19" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <!-- q20 -->
    <label class="required">Propuesta gastron√≥mica</label>
    <div class="satisfaction" id="q20">
      <label><input type="radio" name="q20" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q20" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q20" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q20" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q20" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <!-- q21 -->
    <label class="required">Oferta cultural y tur√≠stica</label>
    <div class="satisfaction" id="q21">
      <label><input type="radio" name="q21" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q21" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q21" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q21" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q21" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <!-- q22 -->
    <label class="required">Manejo de Tr√°nsito</label>
    <div class="satisfaction" id="q22">
      <label><input type="radio" name="q22" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q22" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q22" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q22" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q22" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>

    <label class="required">Estacionamiento y Playas</label>
    <div class="satisfaction" id="qEyP">
      <label><input type="radio" name="qEyP" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="qEyP" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="qEyP" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="qEyP" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="qEyP" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div>    

    <!-- q23 -->
    <label for="q23" class="required">¬øVisitaste el Patio de Do√±a Pipa?</label>
    <select id="q23" name="q23" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Si">Si</option>
      <option value="No">No</option>
      <option value="No lo conozco">No lo conozco</option>
    </select>
    <div class="swankySelect" data-for="q23"></div>

    <div id="q24-container" class="hidden">
      <label class="required">En caso de responder afirmativamente, ¬øC√≥mo calificas el espacio?</label>
      <div class="satisfaction" id="q24">
        <label><input type="radio" name="q24" value="1"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
        <label><input type="radio" name="q24" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
        <label><input type="radio" name="q24" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
        <label><input type="radio" name="q24" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
        <label><input type="radio" name="q24" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
      </div>
    </div>

    <!-- q25 -->
    <!-- <label class="required">19- En una escala del 1 al 5, ¬øC√≥mo calificar√≠as tu experiencia general en el festival?</label>
    <div class="satisfaction" id="q25">
      <label><input type="radio" name="q25" value="1" required><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita1.png" alt="1"></label>
      <label><input type="radio" name="q25" value="2"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita2.png" alt="2"></label>
      <label><input type="radio" name="q25" value="3"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita3.png" alt="3"></label>
      <label><input type="radio" name="q25" value="4"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita4.png" alt="4"></label>
      <label><input type="radio" name="q25" value="5"><img src="https://raw.githubusercontent.com/gisjesusmaria/web/refs/heads/main/festival2026/encuestas/carita5.png" alt="5"></label>
    </div> -->

    <!-- q26 -->
    <label for="q26" class="required">¬øQu√© es lo que M√ÅS te gust√≥ de la visita a nuestra ciudad?</label>
    <textarea id="q26" name="q26" required></textarea>

    <label for="qMen" class="required">¬øQu√© es lo que MENOS te gust√≥ de la visita a nuestra ciudad?</label>
    <textarea id="qMen" name="qMen" required></textarea>    

    <!-- q27 -->
    <label for="q27" class="required">Ten√©s pensado visitar el Festival en la edici√≥n 2027?</label>
    <select id="q27" name="q27" required class="native-select">
      <option value="">Selecciona.</option>
      <option value="Si">Si</option>
      <option value="No se">No se</option>
      <option value="No">No</option>
    </select>
    <div class="swankySelect" data-for="q27"></div>

    <!-- Map -->
    <div id="map-container">
      <label class="required">Ubicaci√≥n actual (aproximada para referencia)</label>
      <div id="map" style="height: 300px; margin-top: 10px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08);"></div>
      <input type="hidden" id="latitude" name="latitude">
      <input type="hidden" id="longitude" name="longitude">
    </div>

    <button type="submit">Enviar</button>
  </form>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <script>

    function buildSwankyForSelect(selectEl, hostEl, indexBadgeText){
      const placeholderText = selectEl.querySelector('option[value=""]')?.textContent?.trim() || "Selecciona.";
      const currentOption = selectEl.selectedOptions?.[0];
      const currentValueText = currentOption && currentOption.value !== "" ? currentOption.textContent.trim() : "";

        hostEl.innerHTML = `
        <button type="button" class="swankyBtn" aria-haspopup="listbox" aria-expanded="false">
            <span class="swankyLeft">
            
                <span class="swankyValue ${currentValueText ? "" : "swankyPlaceholder"}">
                    ${currentValueText || placeholderText}
                </span>
            </span>
            <span class="swankyArrow" aria-hidden="true"></span>
        </button>
        <ul class="swankyList" role="listbox" tabindex="-1"></ul>
        `;    

      const btn = hostEl.querySelector('.swankyBtn');
      const valueEl = hostEl.querySelector('.swankyValue');
      const list = hostEl.querySelector('.swankyList');


      const options = Array.from(selectEl.options)
        .filter(o => o.value !== "");

      list.innerHTML = options.map((o) => {
        const selected = selectEl.value === o.value;
        return `<li class="swankyItem" role="option" tabindex="-1" data-value="${escapeHtml(o.value)}" aria-selected="${selected}">
          ${escapeHtml(o.textContent.trim())}
        </li>`;
      }).join('');

      function setOpen(open){
        hostEl.dataset.open = open ? "true" : "false";
        btn.setAttribute('aria-expanded', open ? "true" : "false");
        if(open){
          const selectedItem = list.querySelector('.swankyItem[aria-selected="true"]') || list.querySelector('.swankyItem');
          selectedItem?.focus();
        }
      }

      function setValue(value){
        selectEl.value = value;

        selectEl.dispatchEvent(new Event('change', { bubbles: true }));

        const opt = Array.from(selectEl.options).find(o => o.value === value);
        valueEl.textContent = opt ? opt.textContent.trim() : placeholderText;
        valueEl.classList.toggle('swankyPlaceholder', !opt);

        list.querySelectorAll('.swankyItem').forEach(li => {
          li.setAttribute('aria-selected', li.dataset.value === value ? "true" : "false");
        });

        setOpen(false);
      }

      btn.addEventListener('click', () => {
        const isOpen = hostEl.dataset.open === "true";
        setOpen(!isOpen);
      });

      list.addEventListener('click', (e) => {
        const li = e.target.closest('.swankyItem');
        if(!li) return;
        setValue(li.dataset.value);
      });

      list.addEventListener('keydown', (e) => {
        const items = Array.from(list.querySelectorAll('.swankyItem'));
        const currentIndex = items.indexOf(document.activeElement);
        if(e.key === 'Escape'){
          e.preventDefault();
          setOpen(false);
          btn.focus();
        }
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          const li = document.activeElement?.closest('.swankyItem');
          if(li) setValue(li.dataset.value);
        }
        if(e.key === 'ArrowDown'){
          e.preventDefault();
          const next = items[Math.min(items.length-1, Math.max(0, currentIndex+1))] || items[0];
          next?.focus();
        }
        if(e.key === 'ArrowUp'){
          e.preventDefault();
          const prev = items[Math.max(0, currentIndex-1)] || items[items.length-1];
          prev?.focus();
        }
      });


      document.addEventListener('click', (e) => {
        if(!hostEl.contains(e.target)) setOpen(false);
      });


      selectEl.addEventListener('change', () => {
        const v = selectEl.value;
        if(!v){
          valueEl.textContent = placeholderText;
          valueEl.classList.add('swankyPlaceholder');
          list.querySelectorAll('.swankyItem').forEach(li => li.setAttribute('aria-selected','false'));
          return;
        }
        const opt = Array.from(selectEl.options).find(o => o.value === v);
        valueEl.textContent = opt ? opt.textContent.trim() : placeholderText;
        valueEl.classList.remove('swankyPlaceholder');
        list.querySelectorAll('.swankyItem').forEach(li => {
          li.setAttribute('aria-selected', li.dataset.value === v ? "true" : "false");
        });
      });


      hostEl.dataset.open = "false";
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    function initSwanky(){
      const hosts = document.querySelectorAll('.swankySelect[data-for]');
      
      hosts.forEach((host, i) => {
        const id = host.getAttribute('data-for');
        const select = document.getElementById(id);
        if(!select) return;
        
        select.classList.add('native-select');
        buildSwankyForSelect(select, host, String(i+1));
      });
    }

    function initConditionalLogic(){

        // const q2 = document.getElementById('q2');
        // const q3Container = document.getElementById('q3-container');
        // const q3Label = document.getElementById('q3-label');

        // q2.addEventListener('change', () => {
        // const esVecino =
        //     q2.value === 'Vecino de la zona (Jes√∫s Mar√≠a, Colonia Caroya, Sinsacate)';

        // const noEligioNada = q2.value === '';

        // const debeMostrarQ3 = !(esVecino || noEligioNada);

        // q3Container.classList.toggle('hidden', !debeMostrarQ3);

        // // ‚úÖ asterisco rojo solo cuando corresponde
        // q3Label.classList.toggle('required', debeMostrarQ3);
        // });



    //   const q9 = document.getElementById('q9');
    //   const q10Container = document.getElementById('q10-container');
    //   q9.addEventListener('change', () => {
    //     q10Container.classList.toggle('hidden', q9.value !== 'Otra');
    //   });


    // const q9 = document.getElementById('q9');
    // const q10Container = document.getElementById('q10-container');
    // const q10 = document.getElementById('q10');

    // q9.addEventListener('change', () => {
    // const esOtra = q9.value === 'Otra';

    // q10Container.classList.toggle('hidden', !esOtra);

    // // üîí obligatorio solo si eligi√≥ "Otra"
    // q10.toggleAttribute('required', esOtra);

    // // opcional: si deja de ser "Otra", limpio el campo
    // if (!esOtra) q10.value = '';
    // });

    const q9 = document.getElementById('q9');
    const q10Container = document.getElementById('q10-container');
    const q10 = document.getElementById('q10');
    const q10Asterisk = document.getElementById('q10-asterisk');

    q9.addEventListener('change', () => {
    const esOtra = q9.value === 'Otra';

    // mostrar / ocultar input
    q10Container.classList.toggle('hidden', !esOtra);

    // obligatorio din√°mico
    q10.toggleAttribute('required', esOtra);

    // ‚≠ê mostrar / ocultar asterisco rojo
    q10Asterisk.classList.toggle('hidden', !esOtra);

    if (!esOtra) q10.value = '';
    });



      const q15Radios = document.querySelectorAll('input[name="q15"]');
      const q16Container = document.getElementById('q16-container');
      q15Radios.forEach(radio => {
        radio.addEventListener('change', () => {
          const val = parseInt(radio.value, 10);
          q16Container.classList.toggle('hidden', val > 2);
        });
      });

      const q23 = document.getElementById('q23');
      const q24Container = document.getElementById('q24-container');
      q23.addEventListener('change', () => {
        q24Container.classList.toggle('hidden', q23.value !== 'Si');
      });

      
      q2.dispatchEvent(new Event('change', { bubbles:true }));
      q9.dispatchEvent(new Event('change', { bubbles:true }));
      q23.dispatchEvent(new Event('change', { bubbles:true }));
    }

    function initSubmit(){
      const form = document.getElementById('myForm');
      const scriptURL = "https://encjuv.gisjesusmaria.workers.dev";

      

        form.addEventListener('submit', async (e) => {
        e.preventDefault();

        clearValidationUI(form);

        function failAt(el, msg){
        el.classList.add('fieldError');
        showErrorHint(el, msg);
        scrollToEl(el);
        el.querySelector?.('.swankyBtn')?.focus?.();
        return false;
        }
        function failAtGroup(container, msg){
        container.classList.add('groupError');
        showErrorHint(container, msg);
        scrollToEl(container);
        container.querySelector?.('input[type="radio"]')?.focus?.();
        return false;
        }

        
        function requireSelect(id, msg="Te falt√≥ completar esta respuesta."){
        const sel = document.getElementById(id);
        if(sel && !sel.value){
            return failAt(visibleFieldFor(sel), msg);
        }
        return true;
        }

        // q10 obligatorio si q9 == "Otra"
        const q9Val = document.getElementById('q9')?.value;
        if (q9Val === 'Otra') {
        if (!requireText('q10', 'Es obligatorio indicar la ciudad si elegiste "Otra".')) return;
        }


        function requireText(id, msg="Te falt√≥ completar esta respuesta."){
        const el = document.getElementById(id);
        if(el && !String(el.value || '').trim()){
            return failAt(el, msg);
        }
        return true;
        }
        function requireRadioGroup(name, msg="Te falt√≥ elegir una opci√≥n."){
        if(!form.querySelector(`input[name="${name}"]:checked`)){
            const container = radioGroupContainerByName(form, name);
            if(container) return failAtGroup(container, msg);
        }
        return true;
        }
        function requireCheckboxGroup(name, containerId, msg="Te falt√≥ elegir al menos una opci√≥n."){
        if(!form.querySelector(`input[name="${name}"]:checked`)){
            const container = document.getElementById(containerId);
            if(container) return failAtGroup(container, msg);
        }
        return true;
        }



        if(!requireSelect('q1')) return;
        if(!requireSelect('q2')) return;


        
        // const q2Value = document.getElementById('q2').value;
        // const q3Container = document.getElementById('q3-container');
        // const q3 = document.getElementById('q3');

        // const esVecino =
        // q2Value === 'Vecino de la zona (Jes√∫s Mar√≠a, Colonia Caroya, Sinsacate)';

        // if (!esVecino) {
        // if (!q3.value.trim()) {
        //     q3.classList.add('fieldError');
        //     showErrorHint(q3, 'Este campo es obligatorio seg√∫n tu lugar de procedencia.');
        //     scrollToEl(q3);
        //     q3.focus();
        //     return;
        // }
        // }



        if(!requireRadioGroup('q4', 'Te falt√≥ elegir un transporte.')) return;


        // for(const id of ['q5','q6','q7','q8','q9','q11','q12','q13','q14']){
        // if(!requireSelect(id)) return;
        // }

        for(const id of ['q5','q6','q7','q8','q9','q11','q12','q14','qAloj']){
        if(!requireSelect(id)) return;
        }

        // q13 (multi)
        //if(!requireCheckboxGroup('q13', 'q13Multi')) return;

        // q13 (multi)
        if(!requireCheckboxGroup('q13_cb', 'q13Multi')) return;


        // q15 caritas
        if(!requireRadioGroup('q15')) return;

        // q16 condicional si q15 = 1 o 2
        const q15Checked = form.querySelector('input[name="q15"]:checked');
        if(q15Checked && (q15Checked.value === '1' || q15Checked.value === '2')){
        if(!requireText('q16', 'Este campo es obligatorio si calificaste 1 o 2.')) return;
        }

        // q17..q22 caritas
        for(const name of ['q17','q18','q19','q20','q21','q22']){
        if(!requireRadioGroup(name)) return;
        }

        // q23 lista
        if(!requireSelect('q23')) return;

        // q24 condicional (solo si q23 == "Si")
        const q23 = document.getElementById('q23');
        if(q23 && q23.value === 'Si'){
        if(!requireRadioGroup('q24', 'Te falt√≥ calificar este espacio.')) return;
        }

        // q25 caritas
        if(!requireRadioGroup('q25')) return;

        // q26 textarea
        if(!requireText('q26')) return;
        
        if(!requireText('qMen')) return;

        // q27 lista
        if(!requireSelect('q27')) return;


        const q13Hidden = document.getElementById('q13');
        const q13Seleccionados = Array.from(form.querySelectorAll('input[name="q13_cb"]:checked'))
        .map(el => el.value.trim())
        .join(' | ');

        q13Hidden.value = q13Seleccionados;


        const overlay = document.getElementById('submitOverlay');
        const loading = document.getElementById('loadingState');
        const success = document.getElementById('successState');
        const error = document.getElementById('errorState');
        const closeBtn = document.getElementById('closeOverlayBtn');

        const showOverlay = () => overlay.classList.remove('hidden');
        const hideOverlay = () => overlay.classList.add('hidden');
        const setState = (state) => {
            loading.classList.toggle('hidden', state !== 'loading');
            success.classList.toggle('hidden', state !== 'success');
            error.classList.toggle('hidden', state !== 'error');
            closeBtn.classList.toggle('hidden', state === 'loading');
        };

        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.disabled = true;

        showOverlay();
        setState('loading');

        try {
            const res = await fetch(scriptURL, {
            method: 'POST',
            body: new FormData(form)
            });

            if (!res.ok) throw new Error();

            setState('success');

            
            setTimeout(() => {
            hideOverlay();

            
            form.reset();

            
            document.getElementById('q3-container').classList.add('hidden');
            document.getElementById('q10-container').classList.add('hidden');
            document.getElementById('q16-container').classList.add('hidden');
            document.getElementById('q24-container').classList.add('hidden');

            
            clearValidationUI(form);

            
            document.querySelectorAll('select.native-select').forEach(sel => {
                sel.dispatchEvent(new Event('change', { bubbles:true }));
            });

            
            const firstSwanky = document.querySelector('.swankySelect[data-for="q1"]');
            if (firstSwanky) {
                firstSwanky.scrollIntoView({ behavior: 'smooth', block: 'start' });
                firstSwanky.querySelector('.swankyBtn')?.focus();
            } else {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            }, 1700);


        } catch {
            setState('error');
        } finally {
            submitBtn.disabled = false;
        }

        closeBtn.onclick = () => hideOverlay();
        });


    }


    function initMap(){
      const map = L.map('map', {
        zoomControl: false,
        dragging: false,
        scrollWheelZoom: false,
        touchZoom: false,
        doubleClickZoom: false,
        boxZoom: false
      }).setView([0,0], 2);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      const latInput = document.getElementById('latitude');
      const lngInput = document.getElementById('longitude');

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(position => {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;

          latInput.value = Math.round(lat * 1000000);
          lngInput.value = Math.round(lng * 1000000);             

          map.setView([lat, lng], 19);
          //L.marker([lat, lng]).addTo(map);
          L.marker([lat, lng], { icon: L.divIcon({ className: 'blue-marker', html: '<div style="background: blue; width: 20px; height: 20px; border-radius: 50%;"></div>' }) }).addTo(map);
        }, () => {
          
        }, { enableHighAccuracy: true, timeout: 8000, maximumAge: 0 });
      }
    }

    
    initSwanky();
    initConditionalLogic();

    
    document.addEventListener('change', (e) => {
    const t = e.target;

    
    if(t.tagName === 'SELECT' && t.classList.contains('native-select')){
        const host = document.querySelector(`.swankySelect[data-for="${t.id}"]`);
        host?.classList.remove('fieldError');
        host?.nextElementSibling?.classList?.contains('errorHint') && host.nextElementSibling.remove();
    }

   
    if(t.matches('input[type="radio"]')){
        const container = radioGroupContainerByName(document.getElementById('myForm'), t.name);
        container?.classList.remove('groupError');
        
        const next = container?.nextElementSibling;
        if(next && next.classList.contains('errorHint')) next.remove();
    }

    
    if(t.matches('input[type="text"], textarea')){
        t.classList.remove('fieldError');
        const next = t.nextElementSibling;
        if(next && next.classList.contains('errorHint')) next.remove();
    }

    if(t.matches('input[type="checkbox"]')){
    const container = document.getElementById('q13Multi');
    container?.classList.remove('groupError');
    const next = container?.nextElementSibling;
    if(next && next.classList.contains('errorHint')) next.remove();
    }

    });


    function clearValidationUI(form){
    form.querySelectorAll('.fieldError').forEach(el => el.classList.remove('fieldError'));
    form.querySelectorAll('.groupError').forEach(el => el.classList.remove('groupError'));
    form.querySelectorAll('.errorHint').forEach(el => el.remove());
    }

    function showErrorHint(afterEl, text){
    const hint = document.createElement('div');
    hint.className = 'errorHint';
    hint.textContent = text;
    afterEl.insertAdjacentElement('afterend', hint);
    return hint;
    }


    function visibleFieldFor(el){
    if(el.tagName === 'SELECT' && el.classList.contains('native-select')){
        return document.querySelector(`.swankySelect[data-for="${el.id}"]`) || el;
    }
    return el;
    }

    
    function radioGroupContainerByName(form, name){
    
    const map = {
        q4: document.getElementById('q4'),
        q15: document.getElementById('q15'),
        q17: document.getElementById('q17'),
        q18: document.getElementById('q18'),
        q19: document.getElementById('q19'),
        q20: document.getElementById('q20'),
        q21: document.getElementById('q21'),
        q22: document.getElementById('q22'),
        q24: document.getElementById('q24'),
        q25: document.getElementById('q25'),
    };
    return map[name] || null;
    }

    function scrollToEl(el){
    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }



    initSubmit();
    initMap();
  </script>

    
    <div id="submitOverlay" class="overlay hidden" aria-live="polite" aria-busy="true">
    <div class="overlayCard">
        
        <div id="loadingState">
        <div class="spinner" aria-hidden="true"></div>
        <div class="overlayTitle">Registrando encuesta...</div>
        <div class="overlaySub">Por favor, aguard√° un momento.</div>
        </div>

        
        <div id="successState" class="hidden">
        <div class="checkWrap" aria-hidden="true">
            <svg class="checkSvg" viewBox="0 0 52 52">
            <circle class="checkCircle" cx="26" cy="26" r="24" fill="none"></circle>
            <path class="checkMark" fill="none" d="M14 27 L22 35 L38 19"></path>
            </svg>
        </div>
        <div class="overlayTitle successText">¬°Encuesta registrada!</div>
        <div class="overlaySub">Muchas gracias ‚ù§Ô∏è</div>
        </div>

        
        <div id="errorState" class="hidden">
        <div class="overlayTitle" style="color:#b42318;">No se pudo registrar</div>
        <div class="overlaySub">Revis√° tu conexi√≥n e intent√° de nuevo.</div>
        </div>

        <button id="closeOverlayBtn" type="button" class="overlayBtn hidden">Cerrar</button>
    </div>
    </div>

</body>
</html>

