<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Download IP and Time CSV</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico"></link>
</head>
<body>
    <script>
        // Function to format date in GMT-3 with specified format
        function getGMTMinus3Time() {
            const now = new Date();
            const gmtMinus3Offset = -3 * 60; // GMT-3 in minutes
            const localTime = new Date(now.getTime() + (gmtMinus3Offset * 60 * 1000));
            
            const day = String(localTime.getUTCDate()).padStart(2, '0');
            const month = String(localTime.getUTCMonth() + 1).padStart(2, '0');
            const year = localTime.getUTCFullYear();
            const hours = String(localTime.getUTCHours()).padStart(2, '0');
            const minutes = String(localTime.getUTCMinutes()).padStart(2, '0');
            const seconds = String(localTime.getUTCSeconds()).padStart(2, '0');
            
            return `${day}-${month}-${year}_${hours}:${minutes}:${seconds}`;
        }

        // Fetch public IP and trigger CSV download
        async function fetchIPAndDownloadCSV() {
            try {
                const response = await fetch('https://api.ipify.org?format=text', {
                    method: 'GET',
                    headers: { 'Accept': 'text/plain' }
                });
                const ip = await response.text();
                const time = getGMTMinus3Time();
                
                // Create CSV content
                const csvContent = `${ip},${time}`;
                
                // Create a Blob with CSV content
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                
                // Create a temporary link to trigger download
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'ip.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Display fallback message in case download doesn't work
                document.body.innerText = 'CSV file should have downloaded. If not, try again.';
            } catch (error) {
                document.body.innerText = 'Error fetching IP';
            }
        }

        // Run when the page loads
        fetchIPAndDownloadCSV();
    </script>
</body>
</html>


